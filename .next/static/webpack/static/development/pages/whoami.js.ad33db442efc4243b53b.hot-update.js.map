{"version":3,"file":"static/webpack/static\\development\\pages\\whoami.js.ad33db442efc4243b53b.hot-update.js","sources":["webpack:///./actions/authActions.js"],"sourcesContent":["import { AUTHENTICATION, DEAUTHENTICATION } from '../constants/constants';\r\nimport { Cookie } from 'next-cookie';\r\nimport Router from 'next/router';\r\nexport const authentication = user => dispatch => \r\n    fetch(`http://localhost:8000/api/signin`, {\r\n        method: 'POST',\r\n        headers: {\r\n            Accept: 'application/json',\r\n            'Content-Type':'application/json'\r\n        },\r\n        body: JSON.stringify(user)\r\n    })\r\n    .then(data => data.json())\r\n    .then(res =>\r\n       {\r\n        setCookie('token', response.token);\r\n        Router.push('/');\r\n         dispatch({type: AUTHENTICATION, payload: res.token})\r\n       })\r\n    .catch(err => console.log(err));\r\n\r\nexport const setCookie = (key, value) => {\r\n    if(process.browser){\r\n        Cookie.set(key, value, {\r\n            exprires: 1,\r\n            path: '/'\r\n        })\r\n    }\r\n};\r\n\r\nexport const removeCookie = key => {\r\n    if(process.browser){\r\n        cookie.remove(key, {\r\n            exprires: 1\r\n        })\r\n    }\r\n}\r\n\r\nexport const getCookie = (key, req) => {\r\n    return  process.browser ? getCookieFromBrowser(key) : getCookieFromServer(key,req);\r\n}\r\n\r\nconst getCookieFromBrowser = key => {\r\n    return cookie.get(key)\r\n}\r\n\r\nconst getCookieFromServer = (key, req) => {\r\n    if(!req.headers.cookie){\r\n        return undefined;\r\n    }\r\n\r\n    const rawCookie = req.headers.cookie.split(';').find(c => c.trim().startsWith(`${key}=`));\r\n    if(!rawCookie){\r\n        return undefined;\r\n    }\r\n\r\n    return rawCookie.split('=')[1];\r\n}\r\n\r\nexport const reauthenticate = token => dispatch => (dispatch({type: AUTHENTICATION, payload: token}));\r\n\r\nexport const deauthenticate = () => dispatch => {\r\n    removeCookie('token');\r\n    Router.push('/');\r\n    dispatch({type: DEAUTHENTICATION});\r\n}\r\n\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AANA;AAQA;AAAA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAhBA;AAAA;AAkBA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAEA;AACA;AACA;AACA;AADA;AAGA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAJA;;;;A","sourceRoot":""}